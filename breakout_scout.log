2025-04-28 14:14:43,253 - INFO - --- Starting Breakout Scout ---
2025-04-28 14:14:43,254 - INFO - Loading pitch data from 2023-03-30 to 2023-10-01 from mlb_data2.db
2025-04-28 14:15:00,560 - INFO - Estimated rows to process: 713552 in approx 72 chunks.
2025-04-28 14:15:16,894 - INFO - Successfully loaded 713552 rows with columns: ['events', 'release_spin_rate', 'at_bat_number', 'batter', 'pfx_x', 'release_speed', 'delta_home_win_exp', 'game_pk', 'launch_speed', 'pfx_z', 'pitcher', 'launch_angle', 'game_date', 'woba_value', 'pitch_type', 'inning_topbot', 'away_team', 'home_team', 'woba_denom', 'description']
2025-04-28 14:15:16,949 - INFO - Extracting game context...
2025-04-28 14:15:17,212 - INFO - Extracted context for 2415 unique games.
2025-04-28 14:15:17,213 - INFO - Aggregating and calculating scores for 713552 rows...
2025-04-28 14:15:18,360 - INFO - Starting aggregation...
2025-04-28 14:15:18,525 - INFO - Aggregated 48436 batter-game rows.
2025-04-28 14:19:04,759 - INFO - Aggregated 20493 pitcher-game rows.
2025-04-28 14:20:26,042 - INFO - Finished score calculation. Batters: 48436, Pitchers: 20493
2025-04-28 14:20:26,355 - INFO - Raw pitch data deleted from memory.
2025-04-28 14:20:26,380 - INFO - Intermediate daily score DataFrames deleted.
2025-04-28 14:20:26,380 - INFO - Calculating rolling statistics...
2025-04-28 14:20:26,407 - INFO - Calculating rolling percentile with window='30D', min_periods=10
2025-04-28 14:20:34,026 - INFO - Calculating rolling mean with window='30D', min_periods=10
2025-04-28 14:20:34,421 - INFO - Calculating rolling median threshold with window='30D', min_periods=15
2025-04-28 14:20:34,830 - INFO - Finished calculating rolling statistics.
2025-04-28 14:20:34,849 - INFO - Identifying potential breakout performances...
2025-04-28 14:20:34,866 - INFO - Identified 1037 initial breakout candidates.
2025-04-28 14:20:34,866 - INFO - Selecting Top N breakouts per day based on game count...
2025-04-28 14:20:34,972 - INFO - Selected 1037 final breakout performances after daily Top N filtering.
2025-04-28 14:20:34,991 - INFO - Enriching breakout performances with context...
2025-04-28 14:20:34,999 - WARNING - Opponent team enrichment requires player's team ID in breakout data - currently placeholder.
2025-04-28 14:20:35,002 - INFO - Finished enriching breakout performances.
2025-04-28 14:20:35,020 - INFO - Saving 1037 breakout performances to breakouts.db table 'breakout_performances_topN_enriched'...
2025-04-28 14:20:35,060 - INFO - Successfully saved data to table 'breakout_performances_topN_enriched'.
2025-04-28 14:20:35,060 - INFO - --- Breakout Scout Finished ---
2025-04-28 14:20:35,061 - INFO - Total execution time: 351.81 seconds
